# **PA1 若缺失.jar包修正与本地测试方法**

## .jar包缺失处理

- 在按照助教的命令行测试时，输入第二行命令可能发生报错，提示你缺少ANTLR 的 jar 包路径；因此我们需要下载 jar 包并显式指定路径：

```bash
# 下载 ANTLR4 的 jar 包（建议使用 4.13.1 版本，与作业要求一致）
curl -O https://www.antlr.org/download/antlr-4.13.1-complete.jar
```

- 在编译时需要指定 classpath（即将 ANTLR 的 jar 包加入类路径）：

``` bash
javac -cp "antlr-4.13.1-complete.jar:." SysYLexer.java
```

- 运行测试时也需要指定classpath：

```bash
java -cp "antlr-4.13.1-complete.jar:." org.antlr.v4.gui.TestRig SysYLexer tokens -tokens
```

> 可以编写.sy文件进行测试，下一部分介绍。

## 测试文件撰写

- 在最后一步运行测试时，可以预先编写 `.sy` 文件，并在运行测试时将文件路径加入命令行，这里假设在根目录下编写 `test.sy`：

``` bash
java -cp "antlr-4.13.1-complete.jar:." org.antlr.v4.gui.TestRig SysYLexer tokens -tokens test.sy
```

- 示例测试文件如下，可以较完整包含大部分基础测例：

```c
// 单行注释：测试关键字、标识符、十进制整数
const int func_main(int _a, 0b101 /* 多行注释：八进制0123、十六进制0Xabc */) {
    int b_2 = 123;          // 十进制整数 + 下划线结尾的标识符
    int c = 0123;           // 八进制整数（0开头，仅含0-7）
    int d = 0x45F;          // 十六进制整数（0x开头，含a-f）
    int e = 0X678;          // 十六进制整数（0X开头，大写）
    
    // 测试所有运算符和比较符
    if (a == 0 && b != 1) { // IF关键字 + EQ(==) + AND(&&) + NEQ(!=)
        if (c < 2 || d > 3) { // OR(||) + LT(<) + GT(>)
            if (e <= 4 || f >= 5) { // LE(<=) + GE(>=)
                break;      // BREAK关键字
            }
        }
    }
    
    // 测试循环和赋值
    while (a < 10) {        // WHILE关键字
        a = a + 1;          // ASSIGN(=) + PLUS(+)
        if (a % 2 == 0) {   // MOD(%)
            continue;       // CONTINUE关键字
        }
    }
    
    // 测试乘法、除法和返回值
    int res = (a * b) / 2;  // MUL(*) + DIV(/) + 括号
    return res;             // RETURN关键字
}

/* 多行注释：
   1. 验证多行注释被完全过滤
   2. 注释中包含关键字（如int、const）不会被识别
*/
```

- 若获得以下输出，则基础测试通过：

``` bash
[@0,24:28='const',<'const'>,2:0]
[@1,30:32='int',<'int'>,2:6]
[@2,34:42='func_main',<IDENT>,2:10]
[@3,43:43='(',<'('>,2:19]
[@4,44:46='int',<'int'>,2:20]
[@5,48:49='_a',<IDENT>,2:24]
[@6,50:50=',',<','>,2:26]
[@7,52:52='0',<INTEGER_CONST>,2:28]
[@8,53:56='b101',<IDENT>,2:29]
[@9,86:86=')',<')'>,2:62]
[@10,88:88='{',<'{'>,2:64]
[@11,94:96='int',<'int'>,3:4]
[@12,98:100='b_2',<IDENT>,3:8]
[@13,102:102='=',<'='>,3:12]
[@14,104:106='123',<INTEGER_CONST>,3:14]
[@15,107:107=';',<';'>,3:17]
[@16,143:145='int',<'int'>,4:4]
[@17,147:147='c',<IDENT>,4:8]
[@18,149:149='=',<'='>,4:10]
[@19,151:154='0123',<INTEGER_CONST>,4:12]
[@20,155:155=';',<';'>,4:16]
[@21,191:193='int',<'int'>,5:4]
[@22,195:195='d',<IDENT>,5:8]
[@23,197:197='=',<'='>,5:10]
[@24,199:203='0x45F',<INTEGER_CONST>,5:12]
[@25,204:204=';',<';'>,5:17]
[@26,240:242='int',<'int'>,6:4]
[@27,244:244='e',<IDENT>,6:8]
[@28,246:246='=',<'='>,6:10]
[@29,248:252='0X678',<INTEGER_CONST>,6:12]
[@30,253:253=';',<';'>,6:17]
[@31,311:312='if',<'if'>,9:4]
[@32,314:314='(',<'('>,9:7]
[@33,315:315='a',<IDENT>,9:8]
[@34,317:318='==',<'=='>,9:10]
[@35,320:320='0',<INTEGER_CONST>,9:13]
[@36,322:323='&&',<'&&'>,9:15]
[@37,325:325='b',<IDENT>,9:18]
[@38,327:328='!=',<'!='>,9:20]
[@39,330:330='1',<INTEGER_CONST>,9:23]
[@40,331:331=')',<')'>,9:24]
[@41,333:333='{',<'{'>,9:26]
[@42,381:382='if',<'if'>,10:8]
[@43,384:384='(',<'('>,10:11]
[@44,385:385='c',<IDENT>,10:12]
[@45,387:387='<',<'<'>,10:14]
[@46,389:389='2',<INTEGER_CONST>,10:16]
[@47,391:392='||',<'||'>,10:18]
[@48,394:394='d',<IDENT>,10:21]
[@49,396:396='>',<'>'>,10:23]
[@50,398:398='3',<INTEGER_CONST>,10:25]
[@51,399:399=')',<')'>,10:26]
[@52,401:401='{',<'{'>,10:28]
[@53,441:442='if',<'if'>,11:12]
[@54,444:444='(',<'('>,11:15]
[@55,445:445='e',<IDENT>,11:16]
[@56,447:448='<=',<'<='>,11:18]
[@57,450:450='4',<INTEGER_CONST>,11:21]
[@58,452:453='||',<'||'>,11:23]
[@59,455:455='f',<IDENT>,11:26]
[@60,457:458='>=',<'>='>,11:28]
[@61,460:460='5',<INTEGER_CONST>,11:31]
[@62,461:461=')',<')'>,11:32]
[@63,463:463='{',<'{'>,11:34]
[@64,500:504='break',<'break'>,12:16]
[@65,505:505=';',<';'>,12:21]
[@66,536:536='}',<'}'>,13:12]
[@67,546:546='}',<'}'>,14:8]
[@68,552:552='}',<'}'>,15:4]
[@69,578:582='while',<'while'>,18:4]
[@70,584:584='(',<'('>,18:10]
[@71,585:585='a',<IDENT>,18:11]
[@72,587:587='<',<'<'>,18:13]
[@73,589:590='10',<INTEGER_CONST>,18:15]
[@74,591:591=')',<')'>,18:17]
[@75,593:593='{',<'{'>,18:19]
[@76,622:622='a',<IDENT>,19:8]
[@77,624:624='=',<'='>,19:10]
[@78,626:626='a',<IDENT>,19:12]
[@79,628:628='+',<'+'>,19:14]
[@80,630:630='1',<INTEGER_CONST>,19:16]
[@81,631:631=';',<';'>,19:17]
[@82,673:674='if',<'if'>,20:8]
[@83,676:676='(',<'('>,20:11]
[@84,677:677='a',<IDENT>,20:12]
[@85,679:679='%',<'%'>,20:14]
[@86,681:681='2',<INTEGER_CONST>,20:16]
[@87,683:684='==',<'=='>,20:18]
[@88,686:686='0',<INTEGER_CONST>,20:21]
[@89,687:687=')',<')'>,20:22]
[@90,689:689='{',<'{'>,20:24]
[@91,715:722='continue',<'continue'>,21:12]
[@92,723:723=';',<';'>,21:20]
[@93,754:754='}',<'}'>,22:8]
[@94,760:760='}',<'}'>,23:4]
[@95,790:792='int',<'int'>,26:4]
[@96,794:796='res',<IDENT>,26:8]
[@97,798:798='=',<'='>,26:12]
[@98,800:800='(',<'('>,26:14]
[@99,801:801='a',<IDENT>,26:15]
[@100,803:803='*',<'*'>,26:17]
[@101,805:805='b',<IDENT>,26:19]
[@102,806:806=')',<')'>,26:20]
[@103,808:808='/',<'/'>,26:22]
[@104,810:810='2',<INTEGER_CONST>,26:24]
[@105,811:811=';',<';'>,26:25]
[@106,842:847='return',<'return'>,27:4]
[@107,849:851='res',<IDENT>,27:11]
[@108,852:852=';',<';'>,27:14]
[@109,879:879='}',<'}'>,28:0]
[@110,943:942='<EOF>',<EOF>,33:2]
```

